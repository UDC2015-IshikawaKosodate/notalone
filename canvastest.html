<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta http-equiv="content-script-type" content="text/javascript">
<script src="js/jquery-1.11.3.min.js"></script>
<script src="js/encoding.min.js"></script>
</head>

<body>

<input type="file" id="files" class="form" name="files[]" multiple />
<img src="images/notalone_event.png" id="test" />
<br />
<input type="button" onClick="imgSet()" value="imgset">

</body>
</html>

<script>

var IMAGES = [];
function resizeImg(image_data){
    var img0 = new Image();
    img0.src = image_data;
    var canvas0 = document.createElement('canvas');

    var width = img0.width;
    var height = img0.height;
    var chouhen = (width>=height) ? width : height;
    var new_size = 300;  //px
    if (chouhen < new_size){
        var canvaswidth = width;
        var canvasheight = height;
    }
    else{
        var canvaswidth = parseFloat(new_size)/chouhen * width;
        var canvasheight = parseFloat(new_size)/chouhen * height;
    }
    canvas0.width = parseInt(canvaswidth);
    canvas0.height = parseInt(canvasheight);

    var context = canvas0.getContext("2d");
    context.drawImage(img0, 0, 0, canvaswidth, canvasheight);
    var resized_img = canvas0.toDataURL("image/jpeg");
    return resized_img;
}

function handleFileSelect(evt) {
	IMAGES = [];
    var files = evt.target.files; // FileList object

    // Loop through the FileList and render image files as thumbnails.
    for (var i = 0, f; f = files[i]; i++) {
      // Only process image files.
      if (!f.type.match('image.*')) {
        continue;
      }

      var reader = new FileReader();

      // Closure to capture the file information.
      reader.onload = (function(theFile) {
        return function(e) {
          IMAGES.push(resizeImg(e.target.result));

	  document.getElementById('test').src = IMAGES;

	  //alert(IMAGES);

        };
      })(f);

      // Read in the image file as a data URL.
      reader.readAsDataURL(f);
    }
}

function imgSet(){

	var img = document.getElementById('test');

	img.src = "images/notalone_map.png";

}

document.getElementById('files').addEventListener('change', handleFileSelect, false);
</script>


